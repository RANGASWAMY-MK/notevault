<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#6C63FF">
<meta name="description" content="Search, filter, and download college notes across Engineering, Science, Commerce, Arts, and Medical streams.">
<title>NoteVault ‚Äî College Notes Sharing Platform</title>
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
--primary:#6C63FF;--primary-dark:#5A52D5;--primary-light:#8B85FF;
--primary-glow:rgba(108,99,255,0.25);--secondary:#FF6584;--accent:#FFD93D;
--bg:#F0F2F5;--bg-secondary:#E5E7EB;--card-bg:#FFFFFF;--card-bg-hover:#FAFBFC;
--glass:rgba(255,255,255,0.85);--glass-border:rgba(255,255,255,0.3);
--text:#1A202C;--text-secondary:#4A5568;--text-muted:#718096;--text-faint:#A0AEC0;
--border:#E2E8F0;--border-hover:#CBD5E0;--divider:#EDF2F7;
--shadow-xs:0 1px 2px rgba(0,0,0,0.05);--shadow-sm:0 2px 8px rgba(0,0,0,0.06);
--shadow-md:0 4px 16px rgba(0,0,0,0.08);--shadow-lg:0 12px 32px rgba(0,0,0,0.1);
--shadow-xl:0 20px 48px rgba(0,0,0,0.12);--shadow-primary:0 4px 16px rgba(108,99,255,0.3);
--radius-xs:6px;--radius-sm:10px;--radius-md:14px;--radius-lg:20px;
--radius-xl:28px;--radius-full:9999px;
--ease:cubic-bezier(0.4,0,0.2,1);--ease-bounce:cubic-bezier(0.34,1.56,0.64,1);
--ease-spring:cubic-bezier(0.175,0.885,0.32,1.275);
--transition-fast:150ms var(--ease);--transition:300ms var(--ease);--transition-slow:500ms var(--ease);
--stream-engineering:#6C63FF;--stream-science:#0EA5E9;--stream-commerce:#F59E0B;
--stream-arts:#EF4444;--stream-medical:#10B981;
--header-height:280px;--nav-height:60px;
--safe-top:env(safe-area-inset-top,0px);--safe-bottom:env(safe-area-inset-bottom,0px);
--safe-left:env(safe-area-inset-left,0px);--safe-right:env(safe-area-inset-right,0px)
}
[data-theme="dark"]{
--bg:#0F1117;--bg-secondary:#1A1D2E;--card-bg:#1E2235;--card-bg-hover:#252A40;
--glass:rgba(30,34,53,0.9);--glass-border:rgba(255,255,255,0.08);
--text:#E2E8F0;--text-secondary:#A0AEC0;--text-muted:#718096;--text-faint:#4A5568;
--border:#2D3748;--border-hover:#4A5568;--divider:#2D3748;
--shadow-xs:0 1px 2px rgba(0,0,0,0.2);--shadow-sm:0 2px 8px rgba(0,0,0,0.25);
--shadow-md:0 4px 16px rgba(0,0,0,0.3);--shadow-lg:0 12px 32px rgba(0,0,0,0.35);
--shadow-xl:0 20px 48px rgba(0,0,0,0.4)
}
body{
font-family:'Segoe UI',system-ui,-apple-system,BlinkMacSystemFont,'Inter',sans-serif;
background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;
overflow-x:hidden;transition:background var(--transition),color var(--transition);
-webkit-tap-highlight-color:transparent;touch-action:manipulation
}
@media(prefers-reduced-motion:reduce){
*,*::before,*::after{animation-duration:0.01ms!important;transition-duration:0.01ms!important;scroll-behavior:auto!important}
}
::-webkit-scrollbar{width:8px;height:8px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--text-faint);border-radius:4px}
::-webkit-scrollbar-thumb:hover{background:var(--text-muted)}
.scroll-progress{position:fixed;top:0;left:0;height:3px;background:linear-gradient(90deg,var(--primary),var(--secondary),var(--accent));z-index:9999;width:0%;border-radius:0 2px 2px 0;transition:none}
@keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes floatParticle{0%{transform:translateY(100%) rotate(0deg) scale(0);opacity:0}10%{opacity:1;transform:translateY(80%) rotate(72deg) scale(1)}90%{opacity:.8}100%{transform:translateY(-100vh) rotate(720deg) scale(0);opacity:0}}
@keyframes logoFloat{0%,100%{transform:translateY(0) rotate(0deg)}25%{transform:translateY(-4px) rotate(-2deg)}75%{transform:translateY(-2px) rotate(2deg)}50%{transform:translateY(-6px) rotate(0deg)}}
@keyframes cardReveal{from{opacity:0;transform:translateY(40px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes cardShine{0%{left:-150%}100%{left:250%}}
@keyframes rippleAnim{0%{transform:scale(0);opacity:0.5}100%{transform:scale(4);opacity:0}}
@keyframes pulseRing{0%{box-shadow:0 0 0 0 rgba(108,99,255,0.4)}70%{box-shadow:0 0 0 12px rgba(108,99,255,0)}100%{box-shadow:0 0 0 0 rgba(108,99,255,0)}}
@keyframes bookmarkPop{0%{transform:scale(1)}30%{transform:scale(1.5) rotate(15deg)}60%{transform:scale(0.9) rotate(-5deg)}100%{transform:scale(1) rotate(0)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
@keyframes scaleIn{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:scale(1)}}
@keyframes morphBlob{0%,100%{border-radius:60% 40% 30% 70%/60% 30% 70% 40%}50%{border-radius:30% 60% 70% 40%/50% 60% 30% 60%}}
@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
@keyframes breathe{0%,100%{opacity:0.5;transform:scale(1)}50%{opacity:0.8;transform:scale(1.05)}}
@keyframes dropdownOpen{from{opacity:0;transform:translateY(-8px) scale(0.98)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes toastIn{from{opacity:0;transform:translateY(20px) scale(0.85)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes toastOut{from{opacity:1;transform:translateY(0) scale(1)}to{opacity:0;transform:translateY(-16px) scale(0.9)}}
@keyframes modalSlideUp{from{opacity:0;transform:translateY(40px) scale(0.92)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes counterPulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}
@keyframes glowPulse{0%,100%{box-shadow:0 0 5px var(--primary-glow)}50%{box-shadow:0 0 20px var(--primary-glow),0 0 40px rgba(108,99,255,0.1)}}
@keyframes dotBounce{0%,80%,100%{transform:scale(0)}40%{transform:scale(1)}}
.header{
position:relative;
background:linear-gradient(135deg,#4A3AFF 0%,var(--primary) 30%,#7C3AED 70%,#A855F7 100%);
background-size:300% 300%;animation:gradientShift 8s ease infinite;
padding:0;overflow:hidden;min-height:var(--header-height);
display:flex;flex-direction:column;align-items:center;justify-content:center;
padding-top:var(--safe-top)
}
.header::before{
content:'';position:absolute;inset:0;
background:radial-gradient(ellipse at 20% 50%,rgba(255,255,255,0.1) 0%,transparent 70%),
radial-gradient(ellipse at 80% 20%,rgba(168,85,247,0.2) 0%,transparent 50%);
pointer-events:none
}
.header-blob{
position:absolute;border-radius:50%;filter:blur(40px);opacity:0.15;
animation:morphBlob 8s ease-in-out infinite,breathe 4s ease-in-out infinite
}
.header-blob:nth-child(1){width:200px;height:200px;background:#FFD93D;top:-50px;left:-30px;animation-delay:-2s}
.header-blob:nth-child(2){width:150px;height:150px;background:#FF6584;bottom:-40px;right:-20px;animation-delay:-4s}
.header-blob:nth-child(3){width:120px;height:120px;background:#06B6D4;top:40%;left:60%;animation-delay:-6s}
.header-particles{position:absolute;inset:0;overflow:hidden;pointer-events:none}
.particle{position:absolute;border-radius:50%;background:rgba(255,255,255,0.08);animation:floatParticle linear infinite}
.particle.square{border-radius:3px;transform:rotate(45deg)}
.particle.ring{background:transparent;border:2px solid rgba(255,255,255,0.08)}
.header-content{position:relative;z-index:2;text-align:center;padding:2.5rem 1.5rem 3.5rem}
.logo{font-size:clamp(2rem,6vw,2.8rem);font-weight:900;color:white;letter-spacing:-1.5px;line-height:1.1;margin-bottom:0.5rem}
.logo-icon{display:inline-block;animation:logoFloat 3s ease-in-out infinite}
.logo .accent{background:linear-gradient(135deg,#FFD93D,#FF6B6B);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.tagline{color:rgba(255,255,255,0.8);font-size:clamp(0.85rem,2.5vw,1.05rem);font-weight:400;max-width:500px;margin:0 auto}
.stats-bar{display:flex;gap:clamp(1rem,4vw,2rem);justify-content:center;margin-top:1.5rem;flex-wrap:wrap}
.stat-item{text-align:center;color:white}
.stat-number{font-size:clamp(1.2rem,3.5vw,1.6rem);font-weight:800;line-height:1.2;transition:transform 0.2s var(--ease-bounce)}
.stat-number.counting{animation:counterPulse 0.3s var(--ease-bounce)}
.stat-label{font-size:clamp(0.6rem,1.5vw,0.72rem);text-transform:uppercase;letter-spacing:1px;opacity:0.7;font-weight:600}
.theme-toggle{
position:absolute;top:calc(1rem + var(--safe-top));right:calc(1rem + var(--safe-right));z-index:10;
background:rgba(255,255,255,0.15);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);
border:1px solid rgba(255,255,255,0.2);color:white;width:44px;height:44px;
border-radius:var(--radius-full);cursor:pointer;display:flex;align-items:center;justify-content:center;
font-size:1.2rem;transition:all var(--transition)
}
.theme-toggle:hover{background:rgba(255,255,255,0.25);transform:rotate(30deg) scale(1.1)}
.theme-toggle:active{transform:rotate(30deg) scale(0.95)}
.search-container{max-width:680px;margin:-1.8rem auto 0;padding:0 calc(1rem + var(--safe-left));position:relative;z-index:20}
.search-wrapper{position:relative}
.search-bar{
width:100%;padding:1rem 3.5rem 1rem 3.2rem;border:2px solid transparent;border-radius:var(--radius-full);
font-size:clamp(0.9rem,2.5vw,1rem);background:var(--card-bg);color:var(--text);box-shadow:var(--shadow-xl);
transition:all var(--transition);outline:none;font-family:inherit
}
.search-bar:focus{border-color:var(--primary);box-shadow:var(--shadow-xl),0 0 0 4px var(--primary-glow);animation:glowPulse 2s ease-in-out infinite}
.search-bar::placeholder{color:var(--text-faint)}
.search-icon{position:absolute;left:1.1rem;top:50%;transform:translateY(-50%);color:var(--text-faint);font-size:1.15rem;pointer-events:none;transition:all var(--transition)}
.search-bar:focus~.search-icon{color:var(--primary);transform:translateY(-50%) scale(1.15)}
.search-actions{position:absolute;right:0.6rem;top:50%;transform:translateY(-50%);display:flex;align-items:center;gap:0.3rem}
.search-kbd{background:var(--bg-secondary);color:var(--text-muted);font-size:0.7rem;padding:0.15rem 0.5rem;border-radius:4px;font-family:monospace;font-weight:700;border:1px solid var(--border)}
.search-clear-btn{
background:var(--bg-secondary);border:none;color:var(--text-muted);width:32px;height:32px;
border-radius:var(--radius-full);cursor:pointer;display:none;align-items:center;justify-content:center;
font-size:0.9rem;transition:all var(--transition)
}
.search-clear-btn:hover{background:var(--secondary);color:white;transform:rotate(90deg)}
.search-clear-btn.visible{display:flex}
.search-clear-btn.visible+.search-kbd{display:none}
.suggestions-dropdown{
position:absolute;top:calc(100% + 8px);left:0;right:0;background:var(--card-bg);
border-radius:var(--radius-md);box-shadow:var(--shadow-xl);max-height:320px;overflow-y:auto;
z-index:100;display:none;border:1px solid var(--border);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px)
}
.suggestions-dropdown.active{display:block;animation:dropdownOpen 0.2s var(--ease)}
.suggestion-header{padding:0.6rem 1rem;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.8px;color:var(--text-faint);background:var(--bg);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:1}
.suggestion-item{padding:0.7rem 1rem;cursor:pointer;transition:all var(--transition-fast);border-bottom:1px solid var(--divider);display:flex;align-items:center;gap:0.8rem}
.suggestion-item:last-child{border-bottom:none}
.suggestion-item:hover,.suggestion-item.active{background:rgba(108,99,255,0.06)}
.suggestion-item.active{border-left:3px solid var(--primary)}
.suggestion-icon{width:34px;height:34px;border-radius:var(--radius-xs);display:flex;align-items:center;justify-content:center;font-size:0.85rem;flex-shrink:0;transition:transform var(--transition-fast)}
.suggestion-item:hover .suggestion-icon{transform:scale(1.15)}
.suggestion-text{flex:1;min-width:0}
.suggestion-title{font-size:0.92rem;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.suggestion-meta{font-size:0.75rem;color:var(--text-faint)}
.toolbar{max-width:1280px;margin:1.5rem auto 0;padding:0 calc(1rem + var(--safe-left))}
.toolbar-top{display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap;margin-bottom:0.8rem}
.toolbar-left{display:flex;align-items:center;gap:0.6rem;flex-wrap:wrap}
.results-count{font-size:clamp(0.8rem,2vw,0.9rem);color:var(--text-secondary);font-weight:500}
.results-count strong{color:var(--primary);font-weight:700}
.active-filters-tags{display:flex;flex-wrap:wrap;gap:0.4rem}
.active-filter-tag{
display:inline-flex;align-items:center;gap:0.3rem;background:rgba(108,99,255,0.1);
color:var(--primary);font-size:0.78rem;font-weight:600;padding:0.2rem 0.6rem 0.2rem 0.7rem;
border-radius:var(--radius-full);cursor:pointer;transition:all var(--transition-fast);animation:scaleIn 0.2s var(--ease-bounce)
}
.active-filter-tag:hover{background:var(--primary);color:white;transform:scale(1.05)}
.active-filter-tag .tag-remove{font-size:0.9rem;line-height:1;opacity:0.7}
.toolbar-right{display:flex;align-items:center;gap:0.5rem}
.view-toggle{display:flex;background:var(--bg-secondary);border-radius:var(--radius-sm);padding:3px;gap:2px}
.view-btn{
width:36px;height:36px;border:none;border-radius:var(--radius-xs);background:transparent;
color:var(--text-muted);cursor:pointer;display:flex;align-items:center;justify-content:center;
font-size:1rem;transition:all var(--transition-fast);min-height:44px;min-width:44px
}
.view-btn.active{background:var(--card-bg);color:var(--primary);box-shadow:var(--shadow-xs)}
.view-btn:hover:not(.active){color:var(--text);transform:scale(1.05)}
.view-btn:active{transform:scale(0.95)}
.filters-toggle-btn{
display:none;align-items:center;gap:0.5rem;padding:0.6rem 1.1rem;background:var(--card-bg);
border:1.5px solid var(--border);border-radius:var(--radius-sm);cursor:pointer;font-size:0.88rem;
color:var(--text);font-weight:600;transition:all var(--transition);font-family:inherit;min-height:44px
}
.filters-toggle-btn:hover{border-color:var(--primary);color:var(--primary)}
.filters-badge{background:var(--primary);color:white;font-size:0.7rem;min-width:18px;height:18px;border-radius:var(--radius-full);display:none;align-items:center;justify-content:center;font-weight:700}
.filters-badge.visible{display:flex;animation:scaleIn 0.3s var(--ease-bounce)}
.filters-panel{display:flex;flex-wrap:wrap;gap:0.7rem;align-items:flex-end;padding:0.8rem 0}
.filter-group{display:flex;flex-direction:column;gap:0.25rem}
.filter-label{font-size:0.68rem;font-weight:700;color:var(--text-faint);text-transform:uppercase;letter-spacing:0.7px;padding-left:0.2rem}
.filter-select{
padding:0.55rem 2.2rem 0.55rem 0.8rem;border:1.5px solid var(--border);border-radius:var(--radius-sm);
font-size:0.88rem;color:var(--text);background-color:var(--card-bg);cursor:pointer;transition:all var(--transition);
appearance:none;-webkit-appearance:none;min-width:145px;font-family:inherit;min-height:44px;
background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23718096' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
background-repeat:no-repeat;background-position:right 0.7rem center
}
.filter-select:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px var(--primary-glow)}
.filter-select.has-value{border-color:var(--primary);background-color:rgba(108,99,255,0.04)}
.sort-buttons{display:flex;gap:0.35rem}
.sort-btn{
padding:0.55rem 0.9rem;border:1.5px solid var(--border);border-radius:var(--radius-sm);font-size:0.82rem;
color:var(--text-muted);background:var(--card-bg);cursor:pointer;transition:all var(--transition);
font-weight:600;font-family:inherit;display:inline-flex;align-items:center;gap:0.3rem;
min-height:44px;position:relative;overflow:hidden
}
.sort-btn:hover{border-color:var(--primary);color:var(--primary)}
.sort-btn.active{background:var(--primary);color:white;border-color:var(--primary);box-shadow:var(--shadow-primary)}
.sort-btn:active{transform:scale(0.96)}
.clear-all-btn{
padding:0.55rem 1rem;border:1.5px solid var(--secondary);border-radius:var(--radius-sm);font-size:0.82rem;
color:var(--secondary);background:transparent;cursor:pointer;transition:all var(--transition);
font-weight:700;font-family:inherit;min-height:44px;position:relative;overflow:hidden
}
.clear-all-btn:hover{background:var(--secondary);color:white;transform:translateY(-1px);box-shadow:0 4px 12px rgba(255,101,132,0.3)}
.clear-all-btn:active{transform:translateY(0) scale(0.97)}
.tabs-bar{display:flex;gap:0;border-bottom:2px solid var(--border);margin-bottom:0.5rem}
.tab-btn{
padding:0.7rem 1.2rem;font-size:clamp(0.82rem,2vw,0.88rem);font-weight:600;color:var(--text-muted);
background:none;border:none;border-bottom:2px solid transparent;margin-bottom:-2px;
cursor:pointer;transition:all var(--transition-fast);font-family:inherit;display:flex;
align-items:center;gap:0.4rem;min-height:44px;position:relative;overflow:hidden
}
.tab-btn:hover{color:var(--text)}
.tab-btn.active{color:var(--primary);border-bottom-color:var(--primary)}
.tab-btn::after{content:'';position:absolute;bottom:0;left:50%;width:0;height:2px;background:var(--primary);transition:all var(--transition);transform:translateX(-50%)}
.tab-btn:hover::after{width:100%}
.tab-btn.active::after{width:100%}
.tab-count{background:var(--bg-secondary);font-size:0.72rem;padding:0.1rem 0.5rem;border-radius:var(--radius-full);font-weight:700;transition:all var(--transition-fast)}
.tab-btn.active .tab-count{background:rgba(108,99,255,0.12);color:var(--primary)}
.notes-container{max-width:1280px;margin:1rem auto 4rem;padding:0 calc(1rem + var(--safe-left));padding-bottom:var(--safe-bottom)}
.notes-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(min(100%,330px),1fr));gap:1.3rem}
.notes-grid.list-view{grid-template-columns:1fr;gap:0.8rem}
.note-card{
background:var(--card-bg);border-radius:var(--radius-md);overflow:hidden;box-shadow:var(--shadow-sm);
transition:all var(--transition);display:flex;flex-direction:column;position:relative;
opacity:0;transform:translateY(40px) scale(0.95);border:1px solid var(--border);will-change:transform,opacity
}
.note-card.revealed{opacity:1;transform:translateY(0) scale(1)}
.note-card::before{
content:'';position:absolute;top:0;left:-150%;width:60%;height:100%;
background:linear-gradient(90deg,transparent,rgba(255,255,255,0.08),transparent);
z-index:1;pointer-events:none;transition:none
}
.note-card:hover::before{animation:cardShine 0.7s ease forwards}
.note-card:hover{transform:translateY(-6px) scale(1.01);box-shadow:var(--shadow-lg);border-color:var(--border-hover)}
.note-card:active{transform:translateY(-2px) scale(0.995)}
.note-card.bookmarked{box-shadow:var(--shadow-sm),0 0 0 1px rgba(255,217,61,0.3)}
.note-card.bookmarked .bookmark-btn{color:var(--accent)}
.list-view .note-card{flex-direction:row;align-items:stretch}
.list-view .card-accent{width:5px;height:auto;min-height:100%}
.list-view .card-body{flex-direction:row;align-items:center;gap:1.5rem;flex:1}
.list-view .card-badges{margin-bottom:0;flex-shrink:0;flex-direction:column}
.list-view .card-subjects{flex:1}
.list-view .card-subjects h3{margin-bottom:0.2rem}
.list-view .subject-tags{margin-bottom:0}
.list-view .card-footer{border-top:none;border-left:1px solid var(--divider);flex-direction:column;justify-content:center;min-width:140px}
.card-accent{height:4px;flex-shrink:0}
.card-body{padding:1.2rem 1.3rem;flex:1;display:flex;flex-direction:column}
.card-top-row{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:0.7rem}
.card-badges{display:flex;flex-wrap:wrap;gap:0.35rem}
.badge{padding:0.18rem 0.6rem;border-radius:var(--radius-full);font-size:clamp(0.62rem,1.5vw,0.7rem);font-weight:700;letter-spacing:0.3px;text-transform:uppercase;white-space:nowrap;transition:all var(--transition-fast)}
.badge-stream{background:rgba(108,99,255,0.1);color:var(--stream-engineering)}
.badge-stream[data-stream="Science"]{background:rgba(14,165,233,0.1);color:var(--stream-science)}
.badge-stream[data-stream="Commerce"]{background:rgba(245,158,11,0.1);color:var(--stream-commerce)}
.badge-stream[data-stream="Arts"]{background:rgba(239,68,68,0.1);color:var(--stream-arts)}
.badge-stream[data-stream="Medical"]{background:rgba(16,185,129,0.1);color:var(--stream-medical)}
.badge-course{background:var(--bg-secondary);color:var(--text-secondary)}
.badge-year{background:var(--bg-secondary);color:var(--text-secondary)}
.badge-semester{color:white;font-size:0.68rem}
.badge-semester.odd{background:var(--primary)}
.badge-semester.even{background:var(--stream-science)}
.bookmark-btn{
background:none;border:none;color:var(--text-faint);font-size:1.3rem;cursor:pointer;
padding:0.3rem;transition:all var(--transition-fast);flex-shrink:0;line-height:1;min-width:44px;min-height:44px;
display:flex;align-items:center;justify-content:center
}
.bookmark-btn:hover{color:var(--accent);transform:scale(1.2)}
.bookmark-btn:active{transform:scale(0.9)}
.bookmark-btn.pop{animation:bookmarkPop 0.4s var(--ease-bounce)}
.card-subjects{flex:1}
.card-subjects h3{font-size:clamp(0.92rem,2.2vw,1.02rem);font-weight:700;color:var(--text);margin-bottom:0.5rem;line-height:1.35}
.card-subjects h3 .highlight{background:linear-gradient(120deg,rgba(108,99,255,0.15),rgba(108,99,255,0.3));border-radius:3px;padding:0 3px;color:var(--primary-dark);font-weight:800}
[data-theme="dark"] .card-subjects h3 .highlight{color:var(--primary-light)}
.subject-tags{display:flex;flex-wrap:wrap;gap:0.3rem;margin-bottom:0.6rem}
.subject-tag{background:var(--bg);color:var(--text-muted);padding:0.22rem 0.6rem;border-radius:var(--radius-xs);font-size:clamp(0.72rem,1.8vw,0.78rem);font-weight:500;transition:all var(--transition-fast)}
.note-card:hover .subject-tag{background:rgba(108,99,255,0.06);color:var(--primary)}
.card-footer{padding:0.8rem 1.3rem;border-top:1px solid var(--divider);display:flex;justify-content:space-between;align-items:center;gap:0.5rem}
.file-info{font-size:clamp(0.72rem,1.8vw,0.78rem);color:var(--text-faint);display:flex;align-items:center;gap:0.3rem;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.download-btn{
display:inline-flex;align-items:center;gap:0.35rem;padding:0.45rem 1rem;
background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:white;text-decoration:none;
border-radius:var(--radius-full);font-size:0.82rem;font-weight:700;transition:all var(--transition);
box-shadow:0 2px 8px rgba(108,99,255,0.25);white-space:nowrap;border:none;cursor:pointer;
font-family:inherit;min-height:40px;position:relative;overflow:hidden
}
.download-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(108,99,255,0.4)}
.download-btn:active{transform:translateY(0) scale(0.97)}
.download-btn svg{width:14px;height:14px}
.ripple-effect{
position:absolute;border-radius:50%;background:rgba(255,255,255,0.3);
transform:scale(0);animation:rippleAnim 0.6s ease-out;pointer-events:none
}
.no-results{text-align:center;padding:4rem 2rem;display:none}
.no-results.visible{display:block;animation:slideUp 0.5s var(--ease-bounce)}
.no-results-icon{font-size:3.5rem;margin-bottom:1rem;opacity:0.5}
.no-results h3{font-size:clamp(1.1rem,3vw,1.3rem);color:var(--text);margin-bottom:0.4rem}
.no-results p{color:var(--text-muted);font-size:clamp(0.85rem,2vw,0.95rem);max-width:400px;margin:0 auto}
.load-more-container{text-align:center;padding:2rem 0}
.load-more-btn{
padding:0.7rem 2rem;background:var(--card-bg);border:2px solid var(--border);border-radius:var(--radius-full);
font-size:0.92rem;font-weight:600;color:var(--text-secondary);cursor:pointer;transition:all var(--transition);
font-family:inherit;min-height:44px;position:relative;overflow:hidden
}
.load-more-btn:hover{border-color:var(--primary);color:var(--primary);box-shadow:var(--shadow-sm);transform:translateY(-2px)}
.load-more-btn:active{transform:translateY(0) scale(0.98)}
.load-more-dots{display:inline-flex;gap:4px;margin-left:8px}
.load-more-dots span{width:6px;height:6px;border-radius:50%;background:var(--primary);animation:dotBounce 1.4s infinite ease-in-out both}
.load-more-dots span:nth-child(1){animation-delay:-0.32s}
.load-more-dots span:nth-child(2){animation-delay:-0.16s}
.scroll-top-btn{
position:fixed;bottom:calc(2rem + var(--safe-bottom));right:calc(2rem + var(--safe-right));width:48px;height:48px;
border-radius:var(--radius-full);background:var(--primary);color:white;border:none;cursor:pointer;
box-shadow:var(--shadow-primary);display:flex;align-items:center;justify-content:center;
font-size:1.3rem;z-index:50;opacity:0;visibility:hidden;transform:translateY(10px) scale(0.8);transition:all var(--transition)
}
.scroll-top-btn.visible{opacity:1;visibility:visible;transform:translateY(0) scale(1)}
.scroll-top-btn:hover{transform:translateY(-3px) scale(1.1);box-shadow:0 8px 24px rgba(108,99,255,0.45)}
.scroll-top-btn:active{transform:translateY(0) scale(0.95)}
.modal-overlay{
position:fixed;inset:0;background:rgba(0,0,0,0.5);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
z-index:1000;display:none;align-items:center;justify-content:center;padding:1rem
}
.modal-overlay.active{display:flex;animation:fadeIn 0.25s var(--ease)}
.modal{
background:var(--card-bg);border-radius:var(--radius-lg);max-width:520px;width:100%;
box-shadow:var(--shadow-xl);animation:modalSlideUp 0.4s var(--ease-bounce);overflow:hidden;
max-height:90vh;overflow-y:auto
}
.modal-header{padding:1.5rem 1.5rem 0;display:flex;justify-content:space-between;align-items:flex-start}
.modal-close{
background:var(--bg-secondary);border:none;width:36px;height:36px;border-radius:var(--radius-full);
cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--text-muted);
font-size:1rem;transition:all var(--transition-fast);min-width:44px;min-height:44px
}
.modal-close:hover{background:var(--secondary);color:white;transform:rotate(90deg)}
.modal-body{padding:1.2rem 1.5rem 1.5rem}
.modal-badges{display:flex;flex-wrap:wrap;gap:0.4rem;margin-bottom:1rem}
.modal-title{font-size:clamp(1.1rem,3vw,1.25rem);font-weight:800;margin-bottom:1rem;line-height:1.3}
.modal-detail{display:flex;align-items:center;gap:0.6rem;padding:0.5rem 0;font-size:0.9rem;color:var(--text-secondary);border-bottom:1px solid var(--divider);transition:background var(--transition-fast)}
.modal-detail:last-of-type{border-bottom:none}
.modal-detail:hover{background:rgba(108,99,255,0.03);border-radius:var(--radius-xs)}
.modal-detail-icon{width:28px;text-align:center;font-size:1rem}
.modal-actions{display:flex;gap:0.8rem;margin-top:1.5rem;flex-wrap:wrap}
.modal-actions .download-btn{flex:1;justify-content:center;padding:0.7rem 1.5rem;font-size:0.95rem;min-width:160px}
.modal-bookmark-btn{
padding:0.7rem 1.2rem;border:2px solid var(--border);border-radius:var(--radius-full);background:var(--card-bg);
cursor:pointer;font-size:1.1rem;transition:all var(--transition-fast);display:flex;align-items:center;
gap:0.4rem;font-family:inherit;color:var(--text-secondary);min-height:44px
}
.modal-bookmark-btn:hover{border-color:var(--accent);color:var(--accent)}
.modal-bookmark-btn.bookmarked{border-color:var(--accent);color:var(--accent);background:rgba(255,217,61,0.1)}
.toast-container{position:fixed;bottom:calc(2rem + var(--safe-bottom));left:50%;transform:translateX(-50%);z-index:2000;display:flex;flex-direction:column;gap:0.5rem;align-items:center;pointer-events:none}
.toast{
background:var(--text);color:var(--bg);padding:0.7rem 1.5rem;border-radius:var(--radius-full);
font-size:0.88rem;font-weight:600;box-shadow:var(--shadow-lg);pointer-events:auto;
animation:toastIn 0.4s var(--ease-bounce),toastOut 0.3s var(--ease) 2.2s forwards;white-space:nowrap
}
.footer{text-align:center;padding:2rem calc(1rem + var(--safe-left));color:var(--text-faint);font-size:clamp(0.78rem,2vw,0.85rem);border-top:1px solid var(--border);background:var(--card-bg)}
.footer strong{color:var(--primary)}
.footer-links{display:flex;gap:1.5rem;justify-content:center;margin-top:0.5rem;flex-wrap:wrap}
.footer-links a{color:var(--text-muted);text-decoration:none;font-size:0.82rem;transition:all var(--transition-fast);padding:0.3rem}
.footer-links a:hover{color:var(--primary);transform:translateY(-1px)}
.skeleton-card{background:var(--card-bg);border-radius:var(--radius-md);overflow:hidden;border:1px solid var(--border)}
.skeleton-bar{background:linear-gradient(90deg,var(--bg) 25%,var(--bg-secondary) 50%,var(--bg) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite;border-radius:4px}
@media(max-width:480px){
.stats-bar{gap:0.8rem}.stat-item{min-width:60px}.card-badges{gap:0.25rem}
.badge{padding:0.15rem 0.45rem;font-size:0.62rem}.card-body{padding:1rem}
.card-footer{padding:0.7rem 1rem;flex-wrap:wrap}.modal{margin:0.5rem;border-radius:var(--radius-md)}
.modal-actions{flex-direction:column}.modal-actions .download-btn{min-width:unset}
.filters-panel .filter-group{width:100%}
}
@media(max-width:640px){
.toolbar-top{flex-direction:column;align-items:stretch}.toolbar-left{flex-direction:column;align-items:flex-start}
.toolbar-right{justify-content:space-between}.footer-links{gap:1rem}
}
@media(max-width:768px){
.header{min-height:220px}.header-content{padding:2rem 1rem 3rem}
.search-bar{font-size:0.95rem;padding:0.85rem 3.2rem 0.85rem 2.8rem}.search-kbd{display:none}
.filters-toggle-btn{display:flex}
.filters-panel{display:none;flex-direction:column;align-items:stretch;background:var(--card-bg);border:1px solid var(--border);border-radius:var(--radius-md);padding:1rem;margin-top:0.5rem;box-shadow:var(--shadow-md)}
.filters-panel.open{display:flex;animation:slideDown 0.3s var(--ease)}
.filter-select{width:100%;min-width:unset}.sort-buttons{width:100%}.sort-btn{flex:1;justify-content:center}
.clear-all-btn{width:100%;text-align:center}.notes-grid{grid-template-columns:1fr;gap:0.8rem}
.notes-grid.list-view .note-card{flex-direction:column}.list-view .card-accent{width:auto;height:4px;min-height:auto}
.list-view .card-body{flex-direction:column;align-items:stretch}.list-view .card-badges{flex-direction:row}
.list-view .card-footer{border-left:none;border-top:1px solid var(--divider);min-width:unset;flex-direction:row}
.scroll-top-btn{bottom:calc(1.2rem + var(--safe-bottom));right:calc(1.2rem + var(--safe-right));width:44px;height:44px}
.header-blob{display:none}
}
@media(min-width:769px) and (max-width:1024px){.notes-grid{grid-template-columns:repeat(2,1fr)}}
@media(min-width:1440px){
.notes-grid{grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}
.header{min-height:320px}.logo{font-size:3.2rem}
}
@media(min-width:1920px){.notes-container,.toolbar{max-width:1600px}.notes-grid{grid-template-columns:repeat(auto-fill,minmax(380px,1fr))}}
@media(hover:none) and (pointer:coarse){
.note-card:hover{transform:none;box-shadow:var(--shadow-sm)}.note-card:hover::before{animation:none}
.note-card:active{transform:scale(0.98);transition-duration:100ms}.download-btn:hover{transform:none}
.download-btn:active{transform:scale(0.95)}
}
@media(orientation:landscape) and (max-height:500px){
.header{min-height:160px}.header-content{padding:1rem 1rem 2rem}.stats-bar{margin-top:0.5rem}
.search-container{margin-top:-1.2rem}
}
@media print{
.header,.search-container,.toolbar,.scroll-top-btn,.toast-container,.modal-overlay,.footer,.scroll-progress{display:none!important}
.note-card{break-inside:avoid;box-shadow:none;border:1px solid #ddd;page-break-inside:avoid}
.notes-grid{display:block}.note-card{margin-bottom:1rem}.download-btn{display:none}.bookmark-btn{display:none}
body{background:white;color:black}
}
</style>
</head>
<body>
<div class="scroll-progress" id="scrollProgress"></div>
<header class="header" role="banner">
<div class="header-blob"></div>
<div class="header-blob"></div>
<div class="header-blob"></div>
<div class="header-particles" id="headerParticles" aria-hidden="true"></div>
<button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode" title="Toggle theme">üåô</button>
<div class="header-content">
<h1 class="logo"><span class="logo-icon">üìö</span> Note<span class="accent">Vault</span></h1>
<p class="tagline">Your one-stop destination for college notes ‚Äî search, filter &amp; download</p>
<div class="stats-bar" id="statsBar">
<div class="stat-item"><div class="stat-number" id="statNotes">0</div><div class="stat-label">Notes</div></div>
<div class="stat-item"><div class="stat-number" id="statSubjects">0</div><div class="stat-label">Subjects</div></div>
<div class="stat-item"><div class="stat-number" id="statStreams">0</div><div class="stat-label">Streams</div></div>
<div class="stat-item"><div class="stat-number" id="statCourses">0</div><div class="stat-label">Courses</div></div>
</div>
</div>
</header>
<div class="search-container">
<div class="search-wrapper" role="search">
<span class="search-icon" aria-hidden="true">üîç</span>
<input type="text" class="search-bar" id="searchBar" placeholder="Search subjects, courses, streams..." autocomplete="off" aria-label="Search notes" role="combobox" aria-expanded="false" aria-controls="suggestionsDropdown">
<div class="search-actions">
<button class="search-clear-btn" id="searchClear" aria-label="Clear search" title="Clear">‚úï</button>
<kbd class="search-kbd">/</kbd>
</div>
<div class="suggestions-dropdown" id="suggestionsDropdown" role="listbox"></div>
</div>
</div>
<section class="toolbar" id="toolbar">
<div class="toolbar-top">
<div class="toolbar-left">
<span class="results-count" id="resultsCount"></span>
<div class="active-filters-tags" id="activeFiltersTags"></div>
</div>
<div class="toolbar-right">
<button class="filters-toggle-btn" id="filtersToggleBtn">‚öôÔ∏è Filters <span class="filters-badge" id="filtersBadge">0</span></button>
<div class="view-toggle" role="radiogroup" aria-label="View mode">
<button class="view-btn active" data-view="grid" aria-label="Grid view" title="Grid view">‚ñ¶</button>
<button class="view-btn" data-view="list" aria-label="List view" title="List view">‚ò∞</button>
</div>
</div>
</div>
<div class="filters-panel" id="filtersPanel">
<div class="filter-group"><label class="filter-label" for="filterStream">Stream</label><select class="filter-select" id="filterStream"><option value="">All Streams</option></select></div>
<div class="filter-group"><label class="filter-label" for="filterCourse">Course</label><select class="filter-select" id="filterCourse"><option value="">All Courses</option></select></div>
<div class="filter-group"><label class="filter-label" for="filterYear">Year</label><select class="filter-select" id="filterYear"><option value="">All Years</option></select></div>
<div class="filter-group"><label class="filter-label" for="filterSemester">Semester</label><select class="filter-select" id="filterSemester"><option value="">All Semesters</option></select></div>
<div class="filter-group"><label class="filter-label">Sort</label><div class="sort-buttons"><button class="sort-btn" data-sort="semester">üìä Semester</button><button class="sort-btn" data-sort="course">üìÅ Course</button><button class="sort-btn" data-sort="year">üìÖ Year</button></div></div>
<button class="clear-all-btn" id="clearAll">‚úï Clear All</button>
</div>
<div class="tabs-bar">
<button class="tab-btn active" data-tab="all">üìÑ All Notes <span class="tab-count" id="tabAllCount">0</span></button>
<button class="tab-btn" data-tab="bookmarks">‚≠ê Bookmarks <span class="tab-count" id="tabBookmarksCount">0</span></button>
</div>
</section>
<main class="notes-container" role="main">
<div class="notes-grid" id="notesGrid" aria-live="polite"></div>
<div class="no-results" id="noResults"><div class="no-results-icon">üì≠</div><h3>No notes found</h3><p>Try adjusting your search or filters to find what you're looking for.</p></div>
<div class="load-more-container" id="loadMoreContainer" style="display:none"><button class="load-more-btn" id="loadMoreBtn">Load More Notes</button></div>
</main>
<div class="modal-overlay" id="modalOverlay" role="dialog" aria-modal="true" aria-hidden="true">
<div class="modal" id="modal">
<div class="modal-header"><div class="modal-badges" id="modalBadges"></div><button class="modal-close" id="modalClose" aria-label="Close modal">‚úï</button></div>
<div class="modal-body"><h2 class="modal-title" id="modalTitle"></h2><div id="modalDetails"></div><div class="modal-actions" id="modalActions"></div></div>
</div>
</div>
<button class="scroll-top-btn" id="scrollTopBtn" aria-label="Scroll to top" title="Back to top">‚Üë</button>
<div class="toast-container" id="toastContainer" aria-live="assertive"></div>
<footer class="footer" role="contentinfo">
<p>Made with ‚ù§Ô∏è for students everywhere. <strong>NoteVault</strong> ¬© 2025</p>
<div class="footer-links"><a href="#">About</a><a href="#">Contribute Notes</a><a href="#">Contact</a></div>
</footer>

<script>
(function() {
'use strict';

// ============================================================
// DATA ‚Äî 48 notes across 5 streams
// ============================================================
const NOTES_DATA = [
  { id:1, title:"Data Structures & Algorithms", stream:"Engineering", course:"B.Tech CSE", year:2, semester:3, subjects:["Arrays","Linked Lists","Trees","Graphs"], fileType:"PDF", fileSize:"2.4 MB", pages:156, author:"Prof. Sharma" },
  { id:2, title:"Object Oriented Programming", stream:"Engineering", course:"B.Tech CSE", year:2, semester:3, subjects:["Classes","Inheritance","Polymorphism"], fileType:"PDF", fileSize:"1.8 MB", pages:120, author:"Prof. Gupta" },
  { id:3, title:"Database Management Systems", stream:"Engineering", course:"B.Tech CSE", year:2, semester:4, subjects:["SQL","Normalization","ER Model","Transactions"], fileType:"PDF", fileSize:"3.1 MB", pages:198, author:"Prof. Mehta" },
  { id:4, title:"Operating Systems", stream:"Engineering", course:"B.Tech CSE", year:3, semester:5, subjects:["Process Management","Memory","Scheduling","Deadlocks"], fileType:"PDF", fileSize:"2.9 MB", pages:175, author:"Prof. Iyer" },
  { id:5, title:"Computer Networks", stream:"Engineering", course:"B.Tech CSE", year:3, semester:5, subjects:["TCP/IP","OSI Model","Routing","DNS"], fileType:"PDF", fileSize:"2.2 MB", pages:140, author:"Prof. Khan" },
  { id:6, title:"Machine Learning", stream:"Engineering", course:"B.Tech CSE", year:4, semester:7, subjects:["Regression","Classification","Neural Networks","SVM"], fileType:"PDF", fileSize:"4.5 MB", pages:230, author:"Prof. Reddy" },
  { id:7, title:"Digital Electronics", stream:"Engineering", course:"B.Tech ECE", year:2, semester:3, subjects:["Logic Gates","Flip-Flops","Counters","Registers"], fileType:"PDF", fileSize:"1.9 MB", pages:115, author:"Prof. Das" },
  { id:8, title:"Signal Processing", stream:"Engineering", course:"B.Tech ECE", year:3, semester:5, subjects:["Fourier Transform","Filters","Sampling","Z-Transform"], fileType:"PDF", fileSize:"3.3 MB", pages:185, author:"Prof. Nair" },
  { id:9, title:"Thermodynamics", stream:"Engineering", course:"B.Tech ME", year:2, semester:3, subjects:["Laws of Thermodynamics","Entropy","Carnot Cycle"], fileType:"PDF", fileSize:"2.1 MB", pages:130, author:"Prof. Singh" },
  { id:10, title:"Fluid Mechanics", stream:"Engineering", course:"B.Tech ME", year:2, semester:4, subjects:["Bernoulli's Theorem","Viscosity","Flow Types"], fileType:"PDF", fileSize:"2.7 MB", pages:155, author:"Prof. Patel" },
  { id:11, title:"Organic Chemistry", stream:"Science", course:"B.Sc Chemistry", year:1, semester:1, subjects:["Hydrocarbons","Reactions","Stereochemistry","Polymers"], fileType:"PDF", fileSize:"3.6 MB", pages:210, author:"Prof. Verma" },
  { id:12, title:"Inorganic Chemistry", stream:"Science", course:"B.Sc Chemistry", year:1, semester:2, subjects:["Periodic Table","Coordination Compounds","Bonding"], fileType:"PDF", fileSize:"2.5 MB", pages:145, author:"Prof. Agarwal" },
  { id:13, title:"Quantum Mechanics", stream:"Science", course:"B.Sc Physics", year:2, semester:3, subjects:["Wave Functions","Schr√∂dinger Equation","Operators"], fileType:"PDF", fileSize:"4.1 MB", pages:220, author:"Prof. Bose" },
  { id:14, title:"Classical Mechanics", stream:"Science", course:"B.Sc Physics", year:1, semester:1, subjects:["Newton's Laws","Lagrangian","Hamiltonian","Oscillations"], fileType:"PDF", fileSize:"2.8 MB", pages:160, author:"Prof. Chatterjee" },
  { id:15, title:"Linear Algebra", stream:"Science", course:"B.Sc Mathematics", year:1, semester:1, subjects:["Matrices","Vector Spaces","Eigenvalues","Determinants"], fileType:"PDF", fileSize:"1.7 MB", pages:110, author:"Prof. Rao" },
  { id:16, title:"Real Analysis", stream:"Science", course:"B.Sc Mathematics", year:2, semester:3, subjects:["Sequences","Series","Continuity","Differentiability"], fileType:"PDF", fileSize:"2.3 MB", pages:135, author:"Prof. Joshi" },
  { id:17, title:"Molecular Biology", stream:"Science", course:"B.Sc Biology", year:2, semester:4, subjects:["DNA Replication","Transcription","Translation","Gene Regulation"], fileType:"PDF", fileSize:"3.8 MB", pages:195, author:"Prof. Saxena" },
  { id:18, title:"Ecology & Environment", stream:"Science", course:"B.Sc Biology", year:3, semester:5, subjects:["Ecosystems","Biodiversity","Conservation","Climate"], fileType:"PDF", fileSize:"2.6 MB", pages:150, author:"Prof. Mukherjee" },
  { id:19, title:"Electrodynamics", stream:"Science", course:"B.Sc Physics", year:2, semester:4, subjects:["Maxwell's Equations","Electromagnetic Waves","Radiation"], fileType:"PDF", fileSize:"3.2 MB", pages:178, author:"Prof. Menon" },
  { id:20, title:"Probability & Statistics", stream:"Science", course:"B.Sc Mathematics", year:2, semester:4, subjects:["Distributions","Hypothesis Testing","Bayes Theorem"], fileType:"PDF", fileSize:"2.0 MB", pages:125, author:"Prof. Pillai" },
  { id:21, title:"Financial Accounting", stream:"Commerce", course:"B.Com", year:1, semester:1, subjects:["Journal Entries","Ledger","Trial Balance","Final Accounts"], fileType:"PDF", fileSize:"2.4 MB", pages:155, author:"Prof. Jain" },
  { id:22, title:"Cost Accounting", stream:"Commerce", course:"B.Com", year:2, semester:3, subjects:["Cost Sheet","Marginal Costing","Standard Costing"], fileType:"PDF", fileSize:"1.9 MB", pages:118, author:"Prof. Bansal" },
  { id:23, title:"Business Law", stream:"Commerce", course:"B.Com", year:1, semester:2, subjects:["Contract Act","Sale of Goods","Partnership Act"], fileType:"PDF", fileSize:"2.1 MB", pages:132, author:"Prof. Kapoor" },
  { id:24, title:"Macroeconomics", stream:"Commerce", course:"B.Com", year:2, semester:4, subjects:["GDP","Inflation","Fiscal Policy","Monetary Policy"], fileType:"PDF", fileSize:"2.8 MB", pages:162, author:"Prof. Srinivasan" },
  { id:25, title:"Marketing Management", stream:"Commerce", course:"BBA", year:2, semester:3, subjects:["4Ps","Segmentation","Branding","Digital Marketing"], fileType:"PDF", fileSize:"3.0 MB", pages:175, author:"Prof. Malhotra" },
  { id:26, title:"Human Resource Management", stream:"Commerce", course:"BBA", year:2, semester:4, subjects:["Recruitment","Training","Performance Appraisal"], fileType:"PDF", fileSize:"2.2 MB", pages:138, author:"Prof. Chopra" },
  { id:27, title:"Corporate Finance", stream:"Commerce", course:"BBA", year:3, semester:5, subjects:["Capital Budgeting","WACC","Dividend Policy","Mergers"], fileType:"PDF", fileSize:"3.5 MB", pages:192, author:"Prof. Ahluwalia" },
  { id:28, title:"Income Tax Law", stream:"Commerce", course:"B.Com", year:3, semester:5, subjects:["Tax Slabs","Deductions","TDS","Returns Filing"], fileType:"PDF", fileSize:"2.6 MB", pages:148, author:"Prof. Tiwari" },
  { id:29, title:"Microeconomics", stream:"Commerce", course:"B.Com", year:1, semester:1, subjects:["Demand & Supply","Elasticity","Market Structures"], fileType:"PDF", fileSize:"1.8 MB", pages:115, author:"Prof. Deshpande" },
  { id:30, title:"Auditing & Assurance", stream:"Commerce", course:"B.Com", year:3, semester:6, subjects:["Audit Planning","Internal Control","Vouching","Verification"], fileType:"PDF", fileSize:"2.3 MB", pages:140, author:"Prof. Sethi" },
  { id:31, title:"English Literature: Romantics", stream:"Arts", course:"B.A English", year:1, semester:1, subjects:["Wordsworth","Keats","Shelley","Byron"], fileType:"PDF", fileSize:"1.5 MB", pages:98, author:"Prof. Bhatt" },
  { id:32, title:"Modern Indian History", stream:"Arts", course:"B.A History", year:1, semester:2, subjects:["Freedom Movement","Partition","Constitution","Nehru Era"], fileType:"PDF", fileSize:"3.2 MB", pages:188, author:"Prof. Thapar" },
  { id:33, title:"Political Theory", stream:"Arts", course:"B.A Political Science", year:1, semester:1, subjects:["Liberty","Equality","Justice","Rights","Democracy"], fileType:"PDF", fileSize:"2.0 MB", pages:124, author:"Prof. Kaviraj" },
  { id:34, title:"Introduction to Sociology", stream:"Arts", course:"B.A Sociology", year:1, semester:1, subjects:["Social Structure","Culture","Stratification","Deviance"], fileType:"PDF", fileSize:"2.4 MB", pages:142, author:"Prof. Deshpande" },
  { id:35, title:"Abnormal Psychology", stream:"Arts", course:"B.A Psychology", year:2, semester:3, subjects:["Anxiety Disorders","Depression","Schizophrenia","Therapy"], fileType:"PDF", fileSize:"3.1 MB", pages:182, author:"Prof. Kaur" },
  { id:36, title:"Ancient Indian History", stream:"Arts", course:"B.A History", year:1, semester:1, subjects:["Indus Valley","Vedic Age","Maurya Empire","Gupta Dynasty"], fileType:"PDF", fileSize:"2.7 MB", pages:165, author:"Prof. Romila" },
  { id:37, title:"Shakespeare Studies", stream:"Arts", course:"B.A English", year:2, semester:3, subjects:["Hamlet","Macbeth","Othello","Sonnets"], fileType:"PDF", fileSize:"1.8 MB", pages:112, author:"Prof. Naik" },
  { id:38, title:"Indian Philosophy", stream:"Arts", course:"B.A Philosophy", year:2, semester:4, subjects:["Vedanta","Buddhism","Jainism","Nyaya","Yoga"], fileType:"PDF", fileSize:"2.5 MB", pages:148, author:"Prof. Matilal" },
  { id:39, title:"Human Anatomy", stream:"Medical", course:"MBBS", year:1, semester:1, subjects:["Skeletal System","Muscular System","Nervous System"], fileType:"PDF", fileSize:"5.2 MB", pages:310, author:"Prof. Chaurasia" },
  { id:40, title:"Biochemistry", stream:"Medical", course:"MBBS", year:1, semester:2, subjects:["Enzymes","Metabolism","Proteins","Nucleic Acids"], fileType:"PDF", fileSize:"4.8 MB", pages:280, author:"Prof. Satyanarayana" },
  { id:41, title:"Pharmacology", stream:"Medical", course:"MBBS", year:2, semester:4, subjects:["Drug Classification","Pharmacokinetics","ANS Drugs","Antibiotics"], fileType:"PDF", fileSize:"4.2 MB", pages:250, author:"Prof. Tripathi" },
  { id:42, title:"Pathology", stream:"Medical", course:"MBBS", year:2, semester:3, subjects:["Cell Injury","Inflammation","Neoplasia","Hematology"], fileType:"PDF", fileSize:"5.5 MB", pages:325, author:"Prof. Harsh Mohan" },
  { id:43, title:"Microbiology", stream:"Medical", course:"MBBS", year:2, semester:3, subjects:["Bacteria","Viruses","Fungi","Parasites","Immunology"], fileType:"PDF", fileSize:"3.9 MB", pages:215, author:"Prof. Ananthanarayan" },
  { id:44, title:"Pharmaceutical Chemistry", stream:"Medical", course:"B.Pharm", year:2, semester:3, subjects:["Drug Design","SAR","Heterocyclic Compounds"], fileType:"PDF", fileSize:"3.1 MB", pages:180, author:"Prof. Wilson" },
  { id:45, title:"Physiology", stream:"Medical", course:"MBBS", year:1, semester:2, subjects:["Cardiovascular","Respiratory","Renal","Endocrine"], fileType:"PDF", fileSize:"4.6 MB", pages:270, author:"Prof. Guyton" },
  { id:46, title:"Compiler Design", stream:"Engineering", course:"B.Tech CSE", year:3, semester:6, subjects:["Lexical Analysis","Parsing","Code Generation","Optimization"], fileType:"PDF", fileSize:"2.5 MB", pages:145, author:"Prof. Ullman" },
  { id:47, title:"Artificial Intelligence", stream:"Engineering", course:"B.Tech CSE", year:4, semester:7, subjects:["Search Algorithms","Knowledge Representation","NLP","Expert Systems"], fileType:"PDF", fileSize:"3.7 MB", pages:200, author:"Prof. Russell" },
  { id:48, title:"Forensic Medicine", stream:"Medical", course:"MBBS", year:3, semester:5, subjects:["Toxicology","Ballistics","Identification","Medical Jurisprudence"], fileType:"PDF", fileSize:"3.4 MB", pages:190, author:"Prof. Reddy" },
];

// ============================================================
// CONSTANTS & HELPERS
// ============================================================
const STREAM_COLORS = {
  Engineering: 'var(--stream-engineering)',
  Science: 'var(--stream-science)',
  Commerce: 'var(--stream-commerce)',
  Arts: 'var(--stream-arts)',
  Medical: 'var(--stream-medical)'
};
const STREAM_ICONS = { Engineering:'‚öôÔ∏è', Science:'üî¨', Commerce:'üíº', Arts:'üé®', Medical:'üè•' };
const ITEMS_PER_PAGE = 12;

const $ = s => document.querySelector(s);
const $$ = s => document.querySelectorAll(s);

// ============================================================
// STATE
// ============================================================
const state = {
  search: '',
  stream: '',
  course: '',
  year: '',
  semester: '',
  sort: '',
  tab: 'all',
  view: 'grid',
  page: 1,
  bookmarks: JSON.parse(localStorage.getItem('nv_bookmarks') || '[]'),
  filteredNotes: [],
  theme: localStorage.getItem('nv_theme') || 'light'
};

// ============================================================
// DOM REFS
// ============================================================
const dom = {
  scrollProgress: $('#scrollProgress'),
  themeToggle: $('#themeToggle'),
  headerParticles: $('#headerParticles'),
  statNotes: $('#statNotes'),
  statSubjects: $('#statSubjects'),
  statStreams: $('#statStreams'),
  statCourses: $('#statCourses'),
  searchBar: $('#searchBar'),
  searchClear: $('#searchClear'),
  suggestionsDropdown: $('#suggestionsDropdown'),
  resultsCount: $('#resultsCount'),
  activeFiltersTags: $('#activeFiltersTags'),
  filtersToggleBtn: $('#filtersToggleBtn'),
  filtersBadge: $('#filtersBadge'),
  filtersPanel: $('#filtersPanel'),
  filterStream: $('#filterStream'),
  filterCourse: $('#filterCourse'),
  filterYear: $('#filterYear'),
  filterSemester: $('#filterSemester'),
  clearAll: $('#clearAll'),
  notesGrid: $('#notesGrid'),
  noResults: $('#noResults'),
  loadMoreContainer: $('#loadMoreContainer'),
  loadMoreBtn: $('#loadMoreBtn'),
  modalOverlay: $('#modalOverlay'),
  modalBadges: $('#modalBadges'),
  modalTitle: $('#modalTitle'),
  modalDetails: $('#modalDetails'),
  modalActions: $('#modalActions'),
  modalClose: $('#modalClose'),
  scrollTopBtn: $('#scrollTopBtn'),
  toastContainer: $('#toastContainer'),
  tabAllCount: $('#tabAllCount'),
  tabBookmarksCount: $('#tabBookmarksCount')
};

// ============================================================
// INIT
// ============================================================
function init() {
  applyTheme(state.theme);
  generateParticles();
  populateFilters();
  animateCounters();
  applyFilters();
  bindEvents();
}

// ============================================================
// THEME
// ============================================================
function applyTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  dom.themeToggle.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
  document.querySelector('meta[name="theme-color"]').content = theme === 'dark' ? '#0F1117' : '#6C63FF';
  state.theme = theme;
  localStorage.setItem('nv_theme', theme);
}

function toggleTheme() {
  applyTheme(state.theme === 'light' ? 'dark' : 'light');
  showToast(state.theme === 'dark' ? 'üåô Dark mode enabled' : '‚òÄÔ∏è Light mode enabled');
}

// ============================================================
// PARTICLES
// ============================================================
function generateParticles() {
  const container = dom.headerParticles;
  const count = window.innerWidth < 768 ? 8 : 15;
  for (let i = 0; i < count; i++) {
    const p = document.createElement('div');
    const types = ['','square','ring'];
    p.className = 'particle ' + types[Math.floor(Math.random() * types.length)];
    const size = Math.random() * 20 + 5;
    p.style.cssText = `width:${size}px;height:${size}px;left:${Math.random()*100}%;animation-duration:${Math.random()*8+6}s;animation-delay:${Math.random()*5}s;`;
    container.appendChild(p);
  }
}

// ============================================================
// ANIMATED COUNTERS
// ============================================================
function animateCounters() {
  const uniqueSubjects = new Set();
  NOTES_DATA.forEach(n => n.subjects.forEach(s => uniqueSubjects.add(s)));
  const streams = new Set(NOTES_DATA.map(n => n.stream));
  const courses = new Set(NOTES_DATA.map(n => n.course));

  animateNumber(dom.statNotes, NOTES_DATA.length);
  animateNumber(dom.statSubjects, uniqueSubjects.size);
  animateNumber(dom.statStreams, streams.size);
  animateNumber(dom.statCourses, courses.size);
}

function animateNumber(el, target) {
  const duration = 1500;
  const start = performance.now();
  el.classList.add('counting');

  function step(now) {
    const progress = Math.min((now - start) / duration, 1);
    const eased = 1 - Math.pow(1 - progress, 3);
    el.textContent = Math.round(eased * target);
    if (progress < 1) requestAnimationFrame(step);
    else el.classList.remove('counting');
  }
  requestAnimationFrame(step);
}

// ============================================================
// POPULATE FILTER DROPDOWNS
// ============================================================
function populateFilters() {
  const streams = [...new Set(NOTES_DATA.map(n => n.stream))].sort();
  const courses = [...new Set(NOTES_DATA.map(n => n.course))].sort();
  const years = [...new Set(NOTES_DATA.map(n => n.year))].sort();
  const semesters = [...new Set(NOTES_DATA.map(n => n.semester))].sort();

  streams.forEach(s => dom.filterStream.add(new Option(s, s)));
  courses.forEach(c => dom.filterCourse.add(new Option(c, c)));
  years.forEach(y => dom.filterYear.add(new Option('Year ' + y, y)));
  semesters.forEach(s => dom.filterSemester.add(new Option('Semester ' + s, s)));
}

// ============================================================
// FILTER, SORT, RENDER PIPELINE
// ============================================================
function applyFilters() {
  let notes = [...NOTES_DATA];
  const q = state.search.toLowerCase().trim();

  // Tab filter
  if (state.tab === 'bookmarks') {
    notes = notes.filter(n => state.bookmarks.includes(n.id));
  }

  // Search
  if (q) {
    notes = notes.filter(n =>
      n.title.toLowerCase().includes(q) ||
      n.stream.toLowerCase().includes(q) ||
      n.course.toLowerCase().includes(q) ||
      n.subjects.some(s => s.toLowerCase().includes(q)) ||
      n.author.toLowerCase().includes(q)
    );
  }

  // Filters
  if (state.stream) notes = notes.filter(n => n.stream === state.stream);
  if (state.course) notes = notes.filter(n => n.course === state.course);
  if (state.year) notes = notes.filter(n => n.year === Number(state.year));
  if (state.semester) notes = notes.filter(n => n.semester === Number(state.semester));

  // Sort
  if (state.sort === 'semester') notes.sort((a, b) => a.semester - b.semester);
  else if (state.sort === 'course') notes.sort((a, b) => a.course.localeCompare(b.course));
  else if (state.sort === 'year') notes.sort((a, b) => a.year - b.year);

  state.filteredNotes = notes;
  state.page = 1;
  renderNotes();
  updateUI();
}

function renderNotes() {
  const grid = dom.notesGrid;
  const visible = state.filteredNotes.slice(0, state.page * ITEMS_PER_PAGE);

  grid.innerHTML = '';

  if (visible.length === 0) {
    dom.noResults.classList.add('visible');
    dom.loadMoreContainer.style.display = 'none';
    return;
  }
  dom.noResults.classList.remove('visible');

  visible.forEach((note, i) => {
    grid.appendChild(createCard(note, i));
  });

  // Load more
  if (visible.length < state.filteredNotes.length) {
    dom.loadMoreContainer.style.display = '';
    dom.loadMoreBtn.textContent = `Load More (${state.filteredNotes.length - visible.length} remaining)`;
  } else {
    dom.loadMoreContainer.style.display = 'none';
  }

  // Reveal animation
  requestAnimationFrame(() => {
    grid.querySelectorAll('.note-card').forEach((card, i) => {
      setTimeout(() => card.classList.add('revealed'), i * 60);
    });
  });
}

function createCard(note, index) {
  const isBookmarked = state.bookmarks.includes(note.id);
  const semClass = note.semester % 2 === 0 ? 'even' : 'odd';
  const streamColor = STREAM_COLORS[note.stream] || 'var(--primary)';
  const q = state.search.toLowerCase().trim();

  let titleHTML = escapeHTML(note.title);
  if (q) titleHTML = highlightText(titleHTML, q);

  const card = document.createElement('article');
  card.className = 'note-card' + (isBookmarked ? ' bookmarked' : '');
  card.dataset.id = note.id;

  card.innerHTML = `
    <div class="card-accent" style="background:${streamColor}"></div>
    <div class="card-body">
      <div class="card-top-row">
        <div class="card-badges">
          <span class="badge badge-stream" data-stream="${note.stream}">${note.stream}</span>
          <span class="badge badge-course">${note.course}</span>
          <span class="badge badge-semester ${semClass}">Sem ${note.semester}</span>
        </div>
        <button class="bookmark-btn" aria-label="${isBookmarked ? 'Remove bookmark' : 'Bookmark this note'}" data-id="${note.id}">
          ${isBookmarked ? '‚òÖ' : '‚òÜ'}
        </button>
      </div>
      <div class="card-subjects">
        <h3>${titleHTML}</h3>
        <div class="subject-tags">
          ${note.subjects.map(s => `<span class="subject-tag">${escapeHTML(s)}</span>`).join('')}
        </div>
      </div>
    </div>
    <div class="card-footer">
      <span class="file-info">üìÑ ${note.fileType} ‚Ä¢ ${note.fileSize}</span>
      <button class="download-btn" data-id="${note.id}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        Download
      </button>
    </div>
  `;

  return card;
}

// ============================================================
// UPDATE UI ELEMENTS
// ============================================================
function updateUI() {
  // Results count
  const total = state.filteredNotes.length;
  dom.resultsCount.innerHTML = `Showing <strong>${total}</strong> note${total !== 1 ? 's' : ''}`;

  // Tab counts
  dom.tabAllCount.textContent = state.tab === 'all' ? total : NOTES_DATA.length;
  const bmCount = NOTES_DATA.filter(n => state.bookmarks.includes(n.id)).length;
  dom.tabBookmarksCount.textContent = bmCount;

  // Active filter tags
  renderActiveFilterTags();

  // Filter badge
  const activeCount = [state.stream, state.course, state.year, state.semester].filter(Boolean).length;
  dom.filtersBadge.textContent = activeCount;
  dom.filtersBadge.classList.toggle('visible', activeCount > 0);

  // Filter select styling
  dom.filterStream.classList.toggle('has-value', !!state.stream);
  dom.filterCourse.classList.toggle('has-value', !!state.course);
  dom.filterYear.classList.toggle('has-value', !!state.year);
  dom.filterSemester.classList.toggle('has-value', !!state.semester);

  // Update dependent course options based on stream
  updateCoursesForStream();
}

function updateCoursesForStream() {
  const currentVal = dom.filterCourse.value;
  const courses = state.stream
    ? [...new Set(NOTES_DATA.filter(n => n.stream === state.stream).map(n => n.course))].sort()
    : [...new Set(NOTES_DATA.map(n => n.course))].sort();

  dom.filterCourse.innerHTML = '<option value="">All Courses</option>';
  courses.forEach(c => {
    const opt = new Option(c, c);
    if (c === currentVal) opt.selected = true;
    dom.filterCourse.add(opt);
  });
}

function renderActiveFilterTags() {
  const tags = [];
  if (state.stream) tags.push({ label: state.stream, key: 'stream' });
  if (state.course) tags.push({ label: state.course, key: 'course' });
  if (state.year) tags.push({ label: 'Year ' + state.year, key: 'year' });
  if (state.semester) tags.push({ label: 'Sem ' + state.semester, key: 'semester' });
  if (state.search) tags.push({ label: `"${state.search}"`, key: 'search' });

  dom.activeFiltersTags.innerHTML = tags.map(t =>
    `<span class="active-filter-tag" data-key="${t.key}">${escapeHTML(t.label)} <span class="tag-remove">‚úï</span></span>`
  ).join('');
}

// ============================================================
// SEARCH SUGGESTIONS
// ============================================================
function showSuggestions(query) {
  if (!query.trim()) {
    dom.suggestionsDropdown.classList.remove('active');
    dom.searchBar.setAttribute('aria-expanded', 'false');
    return;
  }

  const q = query.toLowerCase();
  const matches = [];

  // Match notes
  NOTES_DATA.forEach(n => {
    const score =
      (n.title.toLowerCase().includes(q) ? 3 : 0) +
      (n.course.toLowerCase().includes(q) ? 2 : 0) +
      (n.stream.toLowerCase().includes(q) ? 2 : 0) +
      (n.subjects.some(s => s.toLowerCase().includes(q)) ? 1 : 0);
    if (score > 0) matches.push({ note: n, score });
  });

  matches.sort((a, b) => b.score - a.score);
  const top = matches.slice(0, 8);

  if (top.length === 0) {
    dom.suggestionsDropdown.classList.remove('active');
    dom.searchBar.setAttribute('aria-expanded', 'false');
    return;
  }

  let html = '<div class="suggestion-header">Suggestions</div>';
  top.forEach(({ note }) => {
    const streamColor = STREAM_COLORS[note.stream] || 'var(--primary)';
    html += `
      <div class="suggestion-item" data-id="${note.id}" role="option">
        <div class="suggestion-icon" style="background:${streamColor}20;color:${streamColor}">${STREAM_ICONS[note.stream] || 'üìÑ'}</div>
        <div class="suggestion-text">
          <div class="suggestion-title">${escapeHTML(note.title)}</div>
          <div class="suggestion-meta">${note.course} ‚Ä¢ Sem ${note.semester}</div>
        </div>
      </div>`;
  });

  dom.suggestionsDropdown.innerHTML = html;
  dom.suggestionsDropdown.classList.add('active');
  dom.searchBar.setAttribute('aria-expanded', 'true');
}

// ============================================================
// MODAL
// ============================================================
function openModal(noteId) {
  const note = NOTES_DATA.find(n => n.id === noteId);
  if (!note) return;

  const isBookmarked = state.bookmarks.includes(note.id);
  const semClass = note.semester % 2 === 0 ? 'even' : 'odd';

  dom.modalBadges.innerHTML = `
    <span class="badge badge-stream" data-stream="${note.stream}">${note.stream}</span>
    <span class="badge badge-course">${note.course}</span>
    <span class="badge badge-year">Year ${note.year}</span>
    <span class="badge badge-semester ${semClass}">Sem ${note.semester}</span>
  `;

  dom.modalTitle.textContent = note.title;

  dom.modalDetails.innerHTML = `
    <div class="modal-detail"><span class="modal-detail-icon">üìö</span><span>Subjects: ${note.subjects.join(', ')}</span></div>
    <div class="modal-detail"><span class="modal-detail-icon">‚úçÔ∏è</span><span>Author: ${note.author}</span></div>
    <div class="modal-detail"><span class="modal-detail-icon">üìÑ</span><span>Format: ${note.fileType} ‚Ä¢ ${note.fileSize}</span></div>
    <div class="modal-detail"><span class="modal-detail-icon">üìñ</span><span>Pages: ${note.pages}</span></div>
    <div class="modal-detail"><span class="modal-detail-icon">üéì</span><span>Year ${note.year}, Semester ${note.semester}</span></div>
  `;

  dom.modalActions.innerHTML = `
    <button class="download-btn" data-id="${note.id}">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
      Download ${note.fileType}
    </button>
    <button class="modal-bookmark-btn${isBookmarked ? ' bookmarked' : ''}" data-id="${note.id}">
      ${isBookmarked ? '‚òÖ Bookmarked' : '‚òÜ Bookmark'}
    </button>
  `;

  dom.modalOverlay.classList.add('active');
  dom.modalOverlay.setAttribute('aria-hidden', 'false');
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  dom.modalOverlay.classList.remove('active');
  dom.modalOverlay.setAttribute('aria-hidden', 'true');
  document.body.style.overflow = '';
}

// ============================================================
// BOOKMARKS
// ============================================================
function toggleBookmark(id) {
  const idx = state.bookmarks.indexOf(id);
  if (idx > -1) {
    state.bookmarks.splice(idx, 1);
    showToast('‚òÜ Bookmark removed');
  } else {
    state.bookmarks.push(id);
    showToast('‚òÖ Note bookmarked!');
  }
  localStorage.setItem('nv_bookmarks', JSON.stringify(state.bookmarks));
  applyFilters();

  // Pop animation on card bookmark button
  const btn = document.querySelector(`.bookmark-btn[data-id="${id}"]`);
  if (btn) { btn.classList.remove('pop'); void btn.offsetWidth; btn.classList.add('pop'); }
}

// ============================================================
// TOAST
// ============================================================
function showToast(message) {
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = message;
  dom.toastContainer.appendChild(toast);
  setTimeout(() => toast.remove(), 2600);
}

// ============================================================
// RIPPLE EFFECT
// ============================================================
function createRipple(e, el) {
  const rect = el.getBoundingClientRect();
  const size = Math.max(rect.width, rect.height);
  const ripple = document.createElement('span');
  ripple.className = 'ripple-effect';
  ripple.style.width = ripple.style.height = size + 'px';
  ripple.style.left = (e.clientX - rect.left - size / 2) + 'px';
  ripple.style.top = (e.clientY - rect.top - size / 2) + 'px';
  el.appendChild(ripple);
  setTimeout(() => ripple.remove(), 600);
}

// ============================================================
// HELPERS
// ============================================================
function escapeHTML(str) {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}

function highlightText(text, query) {
  const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
  return text.replace(regex, '<span class="highlight">$1</span>');
}

// ============================================================
// EVENT BINDINGS
// ============================================================
function bindEvents() {
  // Theme
  dom.themeToggle.addEventListener('click', toggleTheme);

  // Search
  let searchDebounce;
  dom.searchBar.addEventListener('input', (e) => {
    state.search = e.target.value;
    dom.searchClear.classList.toggle('visible', !!state.search);
    clearTimeout(searchDebounce);
    searchDebounce = setTimeout(() => {
      applyFilters();
      showSuggestions(state.search);
    }, 200);
  });

  dom.searchClear.addEventListener('click', () => {
    state.search = '';
    dom.searchBar.value = '';
    dom.searchClear.classList.remove('visible');
    dom.suggestionsDropdown.classList.remove('active');
    dom.searchBar.focus();
    applyFilters();
  });

  // Keyboard shortcut: / to focus search
  document.addEventListener('keydown', (e) => {
    if (e.key === '/' && document.activeElement !== dom.searchBar) {
      e.preventDefault();
      dom.searchBar.focus();
    }
    if (e.key === 'Escape') {
      dom.suggestionsDropdown.classList.remove('active');
      dom.searchBar.setAttribute('aria-expanded', 'false');
      if (dom.modalOverlay.classList.contains('active')) closeModal();
      dom.searchBar.blur();
    }
  });

  // Suggestion clicks
  dom.suggestionsDropdown.addEventListener('click', (e) => {
    const item = e.target.closest('.suggestion-item');
    if (item) {
      const id = Number(item.dataset.id);
      const note = NOTES_DATA.find(n => n.id === id);
      if (note) {
        state.search = note.title;
        dom.searchBar.value = note.title;
        dom.searchClear.classList.add('visible');
        dom.suggestionsDropdown.classList.remove('active');
        applyFilters();
      }
    }
  });

  // Close suggestions on outside click
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.search-wrapper')) {
      dom.suggestionsDropdown.classList.remove('active');
      dom.searchBar.setAttribute('aria-expanded', 'false');
    }
  });

  // Filters
  dom.filterStream.addEventListener('change', (e) => { state.stream = e.target.value; state.course = ''; applyFilters(); });
  dom.filterCourse.addEventListener('change', (e) => { state.course = e.target.value; applyFilters(); });
  dom.filterYear.addEventListener('change', (e) => { state.year = e.target.value; applyFilters(); });
  dom.filterSemester.addEventListener('change', (e) => { state.semester = e.target.value; applyFilters(); });

  // Filter toggle (mobile)
  dom.filtersToggleBtn.addEventListener('click', () => {
    dom.filtersPanel.classList.toggle('open');
  });

  // Sort buttons
  $$('.sort-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      createRipple(e, btn);
      const sort = btn.dataset.sort;
      if (state.sort === sort) {
        state.sort = '';
        btn.classList.remove('active');
      } else {
        $$('.sort-btn').forEach(b => b.classList.remove('active'));
        state.sort = sort;
        btn.classList.add('active');
      }
      applyFilters();
    });
  });

  // Clear all
  dom.clearAll.addEventListener('click', (e) => {
    createRipple(e, dom.clearAll);
    state.search = '';
    state.stream = '';
    state.course = '';
    state.year = '';
    state.semester = '';
    state.sort = '';
    dom.searchBar.value = '';
    dom.searchClear.classList.remove('visible');
    dom.filterStream.value = '';
    dom.filterCourse.value = '';
    dom.filterYear.value = '';
    dom.filterSemester.value = '';
    $$('.sort-btn').forEach(b => b.classList.remove('active'));
    applyFilters();
    showToast('üßπ All filters cleared');
  });

  // Active filter tag removal
  dom.activeFiltersTags.addEventListener('click', (e) => {
    const tag = e.target.closest('.active-filter-tag');
    if (!tag) return;
    const key = tag.dataset.key;
    if (key === 'search') { state.search = ''; dom.searchBar.value = ''; dom.searchClear.classList.remove('visible'); }
    else if (key === 'stream') { state.stream = ''; dom.filterStream.value = ''; }
    else if (key === 'course') { state.course = ''; dom.filterCourse.value = ''; }
    else if (key === 'year') { state.year = ''; dom.filterYear.value = ''; }
    else if (key === 'semester') { state.semester = ''; dom.filterSemester.value = ''; }
    applyFilters();
  });

  // Tabs
  $$('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      $$('.tab-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.tab = btn.dataset.tab;
      applyFilters();
    });
  });

  // View toggle
  $$('.view-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      $$('.view-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      state.view = btn.dataset.view;
      dom.notesGrid.classList.toggle('list-view', state.view === 'list');
    });
  });

  // Notes grid delegation ‚Äî bookmark, download, card click
  dom.notesGrid.addEventListener('click', (e) => {
    const bookmarkBtn = e.target.closest('.bookmark-btn');
    if (bookmarkBtn) {
      e.stopPropagation();
      toggleBookmark(Number(bookmarkBtn.dataset.id));
      return;
    }

    const downloadBtn = e.target.closest('.download-btn');
    if (downloadBtn) {
      e.stopPropagation();
      createRipple(e, downloadBtn);
      const note = NOTES_DATA.find(n => n.id === Number(downloadBtn.dataset.id));
      if (note) showToast(`‚¨áÔ∏è Downloading "${note.title}"...`);
      return;
    }

    const card = e.target.closest('.note-card');
    if (card) {
      openModal(Number(card.dataset.id));
    }
  });

  // Modal
  dom.modalClose.addEventListener('click', closeModal);
  dom.modalOverlay.addEventListener('click', (e) => {
    if (e.target === dom.modalOverlay) closeModal();
  });

  // Modal actions delegation
  dom.modalActions.addEventListener('click', (e) => {
    const downloadBtn = e.target.closest('.download-btn');
    if (downloadBtn) {
      createRipple(e, downloadBtn);
      const note = NOTES_DATA.find(n => n.id === Number(downloadBtn.dataset.id));
      if (note) showToast(`‚¨áÔ∏è Downloading "${note.title}"...`);
      return;
    }

    const bmBtn = e.target.closest('.modal-bookmark-btn');
    if (bmBtn) {
      const id = Number(bmBtn.dataset.id);
      toggleBookmark(id);
      const isNowBookmarked = state.bookmarks.includes(id);
      bmBtn.classList.toggle('bookmarked', isNowBookmarked);
      bmBtn.innerHTML = isNowBookmarked ? '‚òÖ Bookmarked' : '‚òÜ Bookmark';
    }
  });

  // Load more
  dom.loadMoreBtn.addEventListener('click', (e) => {
    createRipple(e, dom.loadMoreBtn);
    state.page++;
    renderNotes();
  });

  // Scroll progress + back to top
  let scrollTicking = false;
  window.addEventListener('scroll', () => {
    if (!scrollTicking) {
      requestAnimationFrame(() => {
        const scrolled = window.scrollY;
        const height = document.documentElement.scrollHeight - window.innerHeight;
        const progress = height > 0 ? (scrolled / height) * 100 : 0;
        dom.scrollProgress.style.width = progress + '%';
        dom.scrollTopBtn.classList.toggle('visible', scrolled > 400);
        scrollTicking = false;
      });
      scrollTicking = true;
    }
  });

  dom.scrollTopBtn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
}

// ============================================================
// BOOT
// ============================================================
document.addEventListener('DOMContentLoaded', init);

})();
</script>
</body>
</html>
